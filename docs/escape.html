<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escape Game Terminal</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #1e1e2e;
            color: #cdd6f4;
            font-family: monospace;
            height: 100vh;

            display: flex;
            flex-direction: column;
        }

        #terminal {
            flex-grow: 1;
            padding: 10px;
            overflow-y: auto;
            font-size: 1.1em;
            line-height: 1.3;
            scrollbar-width: none;
        }

        .terminal-line {
            /* white-space: pre-wrap; */
            /* Conserve les espaces et wrap */
            word-break: break-word;
            /* Force le cas √©ch√©ant */
            font-family: monospace;
            /* margin: 2px 0; */
        }

        #input-container {
            padding: 10px;
            background-color: #313244;
            position: sticky;
            bottom: 0;
        }

        #input {
            width: calc(100% - 20px);
            padding: 10px;
            background-color: #1e1e2e;
            border: 1px solid #45475a;
            color: #cdd6f4;
            font-family: monospace;
            font-size: 1.1em;
            border-radius: 0.25em;
        }

        .narration {
            color: #74c7ec;
        }

        .success {
            color: #6FC6A8;
        }

        .error {
            color: #f38ba8;

        }

        .bad {
            /* color: #1e1e2e; */
            background-color: #d20f39;
            font-weight: bold;
        }

        .typing-container {
            display: inline;
            position: relative;
        }

        .typing-cursor {
            position: absolute;
            right: -2px;
            border-right: 2px solid #6FC6A8;
            animation: blink 1s step-end infinite;
        }

        .user {
            font-weight: bold;
            padding: 10px 0;
        }

        .comment {
            color: #9399b2;
            font-style: italic;
        }

        @keyframes blink {

            from,
            to {
                border-color: transparent
            }

            50% {
                border-color: #6FC6A8;
            }
        }

        .terminal-line {
            margin: 2px 0;
        }
    </style>
</head>

<body>
    <div id="terminal"></div>
    <div id="input-container">
        <input type="text" id="input" placeholder="Tapez votre r√©ponse ici...">
    </div>
    <script>
        const terminal = document.getElementById('terminal');
        const input = document.getElementById('input');
        let currentEnigme = 1;
        let isTyping = false;
        let enigmeShown = false;
        let currentTyping = {
            resolve: null,
            reject: null,
            timeout: null
        };
        let debug = false;
        let nbtry = 0;

        async function addLine(text, className = '', typing = true, speed = 30) {
            const lines = text.split('\n');
            for (let i = 0; i < lines.length; i++) {
                const line = document.createElement('div');
                line.className = `terminal-line ${className}`;
                terminal.appendChild(line);

                if (lines[i] === '') {
                    line.innerHTML = '&nbsp;';
                } else if (typing) {
                    await typeWriter(lines[i], line, speed);
                } else {
                    // Ne transforme que les espaces de d√©but de ligne
                    const leadingSpaces = lines[i].match(/^ +/)?.[0] || '';
                    const restOfLine = lines[i].slice(leadingSpaces.length);
                    line.innerHTML = leadingSpaces.replace(/ /g, '&nbsp;') + restOfLine;
                }
                terminal.scrollTop = terminal.scrollHeight;
            }
        }

        async function typeWriter(text, element, speed = 30) {
            isTyping = true;
            let skipRequested = false || debug;

            // Ne transforme que les espaces de d√©but
            const leadingSpaces = text.match(/^ +/)?.[0] || '';
            const restOfText = text.slice(leadingSpaces.length);
            const processedText = leadingSpaces.replace(/ /g, '\u00A0') + restOfText;

            const container = document.createElement('span');
            container.className = 'typing-container';
            element.appendChild(container);

            const cursor = document.createElement('span');
            cursor.className = 'typing-cursor';
            container.appendChild(cursor);

            for (let i = 0; i < processedText.length; i++) {
                if (skipRequested) {
                    container.insertBefore(document.createTextNode(processedText.substring(i)), cursor);
                    break;
                }

                container.insertBefore(document.createTextNode(processedText[i]), cursor);

                try {
                    await new Promise((resolve, reject) => {
                        currentTyping.resolve = resolve;
                        currentTyping.reject = reject;
                        currentTyping.timeout = setTimeout(resolve, speed);
                    });
                } catch {
                    skipRequested = true;
                    i--;
                    continue;
                }

                terminal.scrollTop = terminal.scrollHeight;
            }

            container.removeChild(cursor);
            isTyping = false;
            currentTyping = { resolve: null, reject: null, timeout: null };
            terminal.scrollTop = terminal.scrollHeight;
        }

        let skipWait = false;

        function wait(ms) {
            if (debug) return Promise.resolve(true);
            return new Promise((resolve) => {
                const timeout = setTimeout(() => {
                    document.removeEventListener('keydown', onKeyDown);
                    resolve(false); // Attente termin√©e naturellement
                }, ms);

                function onKeyDown(e) {
                    if (e.key === 'Enter') {
                        clearTimeout(timeout);
                        document.removeEventListener('keydown', onKeyDown);
                        skipWait = true;
                        resolve(true); // Attente √©court√©e
                    }
                }

                document.addEventListener('keydown', onKeyDown);
            });
        }

        async function showEnigme() {
            enigmeShown = true;
            if (currentEnigme === 1) {
                await addLine(`OH LA BARBE ! Un hacker s'est infiltr√© sur le serveur du lyc√©e de l'Emp√©ri !`, 'error')
                await wait(1000);
                await addLine(`\nPar chance, ce petit malin semble avoir laiss√© plein d'indices pour retrouver sa trace.\n`, 'narration')
                await wait(1000);
                await addLine(`Le professeur de NSI, M. Rouquan, occup√© √† corriger ses copies et √† jouer du ukul√©l√©, n'a pas d'autre choix que de vous laissez mener l'enqu√™te.`, 'narration')
                await wait(1000);
                await addLine(`\nVous √™tes les experts en informatique du lyc√©e apr√®s tout, pas vrai ?`, 'narration')

            }
            else if (currentEnigme === 2) {
                await wait(1000);
                await addLine(`Vous vous tenez devant le terminal d‚Äôacc√®s au serveur du lyc√©e, pr√™t √† r√©veiller cette machine d'un autre mill√©naire.`, 'narration');
                await wait(3000);
                await addLine(`\nVous appuyez sur le bouton d‚Äôallumage, et √† peine l‚Äôavez vous fait, la b√™te se r√©veille de son coma dans un nuage de poussi√®re, √©mettant des bips √©tranges, presque comme des r√¢les d‚Äôagonie.`, 'narration');
                await wait(1000);
                await addLine(`\n*beep*`, 'comment', false, 0)
                await wait(1000);
                await addLine(`*boop*`, 'comment', false, 0)
                await wait(1000);
                await addLine(`*schlink*`, 'comment', false, 0)
                await wait(1000);
                await addLine(`*schwagabada*`, 'comment', false, 0)
                await wait(1000);
                await addLine(`*aaaaaAAAAAAaaaaAAAAAAAAAHAHHHHHHHHHHHHH*`, 'comment', false, 0)
                await wait(1000);
                await addLine(`\nPendant que vous vous demandez si cette machine a connu Alan Turing, l‚Äô√©cran s‚Äôallume et affiche :\n`, 'narration');
                await wait(1000);
                await addLine(`D√©marrage sur la disquette...\n`, '', true, 100)
                await addLine(`‚ô´ÔΩ•*:.ÔΩ°. .ÔΩ°.:* (·É¶Àò‚å£Àò·É¶) ‚ô´ÔΩ•*:.ÔΩ°. .ÔΩ°.:*ÔΩ•`, '', true, 100)
                await addLine(`\nD√©marrage effectu√© avec succ√®s !\n`, true, 100)
                await addLine(`               __________
              / ======== \\
             / ___________\\
            | ____________ |
            | | TERMINAL | |
            | | =EMPERI= | |
            | |__________| |
            \\=_____________/  
            / """""""""""" \\ 
           / :::::::::::::: \\ 
          (__________________)`, '', true, 1)

                await addLine(`\nBienvenue sur le terminal d'acc√®s au serveur du lyc√©e de l'Emp√©ri √† Salon-de-Provence !`)
                await addLine(`\nEntrez le mot de passe :`)
            }
            else if (currentEnigme === 3) {
                await addLine(`Ce bon vieux Chichi ! ‚Äî Si on oublie qu'il a √©t√© condamn√© pour d√©tournement de fonds publics ‚Äî`, 'narration');
                await wait(1000);
                await addLine(`\nApr√®s de longs crissements de la disquette, le terminal vous affiche :`, 'narration');
                await wait(1000);
                await addLine(`\nConnexion au r√©seau...`, '', true);
                await addLine(`‚ô´ÔΩ•*:.ÔΩ°. .ÔΩ°.:* (·É¶Àò‚å£Àò·É¶) ‚ô´ÔΩ•*:.ÔΩ°. .ÔΩ°.:*ÔΩ•`, '', true, 100)
                await wait(100);
                await addLine(`√âchec de la connexion ‡≤•Ôπè‡≤•`, 'error');
                await wait(1000);
                await addLine(`\n/!\\ L'adresse de la passerelle est corrompue /!\\`, 'error');
                await addLine(`Mettez √† jour l'adresse IP de la passerelle via la commande :`);
                await addLine(`\n    > route XXX.XXX.XXX.XXX`);
                await addLine(`\nO√π XXX.XXX.XXX.XXX est l'adresse IP de la passerelle.`);
                await addLine(`\nD√©cid√©ment, c'est pas votre jour...`, 'narration');
            }
            else if (currentEnigme === 4) {
                await addLine(`Mise √† jour de la bo√Æte de messagerie...`)
                await wait(100);
                await addLine(`\nVous avez re√ßu 1 nouveau message le 4/04/2025`)
                await wait(100);
                await addLine(`\n                    ...
                  /'‚†Ä‚†Ä‚†Ä'\\
                 / ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä\\
                |\\~~~~~~~/|
                | \\=====/ |
                | /'...'\\ |
                |/_______\\|`, '', true, 1)
                await addLine(`\nLe message a √©t√© d√©pos√© dans vos documents.`)
                await wait(100);
                await addLine(`\nUn nouveau message ? Aujourd'hui ?!`, 'narration')

            }
            else if (currentEnigme === 5) {
                await addLine(`De    : ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà
√Ä     : 192.168.20.1
Date  : 4/04/2025 √† 8h30
---
Alors comme √ßa on tente de m'attraper ?
Avec cette antiquit√© ringarde sous tes doigts ?

Voyons-voir ce que tu vaux petit...

Quelle est la r√©ponse √† la grande question sur
la vie, l'Univers et le reste ?... en binaire.`)
                await wait(200);
                await addLine(`\n¬´ La grande question sur la vie, l'Univers et le reste ? Il a fum√© sa carte m√®re lui ? ¬ª soupirez-vous.`, 'narration')
                await wait(2000);
                await addLine(`\nSoudain, l'√©cran se met √† trembler et les ventilateurs de la machine grondent :\n`, 'narration')
                await wait(200);
                await addLine(`&&)√†√ßr√ß!!)___ 09ZE09RZ
ZE09R0¬∞--- !!*#
C0RRUPT!0N DE LA M√âM0IRE
√©"√†√ß)!'√®√®! @#$~~%??
AHAHAH!! CE M3SS@GE A ETE PI3G√â
√ß√†√ß'#~####~~~- √®√®"√¶¬∂.....??????dskf√©"''
^%#&00|><\\~~~... Connection LOST!
>>> D0nNe mOi Ta r√©P0nse PLUS VITE : ***>>>`, 'bad')
                await wait(500);
                await addLine(`\nOh... effrayant... il a l'air d'√™tre un vrai m√©chant pas beau lui. Tant pis, il va falloir rentrer dans son jeu pour en apprendre plus.`, 'narration')

            }
            else if (currentEnigme === 6) {
                await addLine(`Bien jou√©... mais ce n'√©tait qu'un √©chauffement.`, 'success')
                await wait(100);
                await addLine(`\nTu as pris la sp√©cialit√© NSI, hein ? Tu sais donc le r√©sultat de 0.1 + 0.2 ?`, 'error')
                await wait(500);
                await addLine(`\n¬´ Avoir pris la sp√©cialit√© NSI et suivre les cours de NSI sont deux choses bien diff√©rentes. ¬ª marmonnez-vous. La quesiton vous semble trop √©vidente.`, 'narration')

            }
            else if (currentEnigme === 7) {
                await addLine(`\nTu as cru que tu allais r√©pondre √† des questions de cours tranquillement ?`, 'error')
                await wait(500);
                await addLine(`\nQuelle insouciance...`, 'error', true, 100)
                await wait(1000);
                await addLine(`\n*bip*`, 'comment', false)
                await wait(500);
                await addLine(`\nHm ?`, 'narration')
                await wait(1000);
                await addLine(`\n*bip*`, 'comment', false)
                await wait(500);
                await addLine(`\nHein ?`, 'narration')
                await wait(1000);
                await addLine(`\n*bip*`, 'comment', false)
                await wait(500);
                await addLine(`\nCela semble venir de la machine... mais les bips semblent bien diff√©rents cette fois-ci.`, 'narration')
                await wait(500);
                await addLine(`\n*bip*`, 'comment', false)
                await wait(1000);
                await addLine(`\nSi j'√©tais toi, je regarderais √† l'int√©rieur de la machine...`, 'error')
                await addLine(`Tic...`, 'error', true, 500)
                await addLine(`Tac...`, 'error', true, 500)
                await wait(500);
                await addLine(`\nVos mains moites s‚Äôapprochent de la machine, pr√™tes √† l‚Äô√©ventrer... vous soulevez le couvercle et... UNE BOMBE ?! Pourtant, l‚Äôusage d‚Äôexplosifs est formellement interdit dans l‚Äôenceinte du lyc√©e. Et, en y r√©fl√©chissant, probablement ailleurs aussi.`, 'narration')
                await wait(1000);
                await addLine(`\nC'est tout de suite plus fun ! Pour d√©sarmorcer cette bombe, il va falloir que tu coupes les c√¢bles dans un certain ordre... regarde bien : chaque c√¢ble est num√©rot√© dans l‚Äôordre croissant.`, 'error')
                await wait(1000);
                await addLine(`\nEffectivement, les c√¢bles du m√©canisme portent les num√©ros :`, 'narration')

                await addLine(`\n5-6-8-12-14-16-18-19-20-23-26-27-28-28-29-30-33-35-36-38-42-46-50-88-94-105-106-114-117-123-128`, 'narration')
                await wait(1000);
                await addLine(`\n¬´ √áa fait vraiment beaucoup de c√¢bles... ¬ª pensez-vous.`, 'narration')
                await wait(1000);
                await addLine(`\nTu dois les couper en suivant une recherche dichotomique, comme si tu cherchais le nombre 42 dans cette liste tri√©e de num√©ros.`, 'error')
                await wait(1000);
                await addLine(`\n¬´ La recherche dichoquoicoubeh ...? ¬ª Voil√† un casse-t√™te digne de votre niveau.`, 'narration')
                await wait(500);
                await addLine(`\nDonne les c√¢bles que tu coupes... comme : ¬´ 5 6 8 ¬ª (ne fais pas √ßa ou tu risques d'√™tre toi aussi d√©coup√© en deux ahahah)`, 'error')

            }
            else if (currentEnigme === 8) {
                await addLine(`\nDommage... tu es plus coriace que pr√©vu...`, 'error')
                await wait(500);
                await addLine(`Mais as-tu fais atttention √† l'arri√®re de la bombe ? Non parce que je tiens vraiment √† ta survie tu sais.`, 'error')
                await wait(500);
                await addLine(`\nIl commence s√©rieusement √† vous taper sur le syst√®me d'exploitation, celui-l√†... vous retournez la bombe et, sans surprise, un nouveau m√©canisme vous attend. Cette fois, ce sont de petites roues crant√©es √† d√©filer.\n`, 'narration')
                await wait(500);
                await addLine(`‚ï≠ ‚îè‚îÅ‚îÅ‚îÅ‚îì   ‚îè‚îÅ‚îÅ‚îÅ‚îì   ‚îè‚îÅ‚îÅ‚îÅ‚îì ‚ïÆ   ‚ï≠ ‚îè‚îÅ‚îÅ‚îÅ‚îì   ‚îè‚îÅ‚îÅ‚îÅ‚îì ‚ïÆ 
‚îÇ ‚îÉ 1 ‚îÉ√ó‚îÉ 7 ‚îÉ‚Äî‚îÉ 19‚îÉ ‚îÇ√∑‚îÇ ‚îÉ 3 ‚îÉ+‚îÉ11 ‚îÉ ‚îÇ = 199
‚ï∞ ‚îó‚îÅ‚îÅ‚îÅ‚îõ   ‚îó‚îÅ‚îÅ‚îÅ‚îõ   ‚îó‚îÅ‚îÅ‚îÅ‚îõ ‚ïØ   ‚ï∞ ‚îó‚îÅ‚îÅ‚îÅ‚îõ   ‚îó‚îÅ‚îÅ‚îÅ‚îõ ‚ïØ`, 'narration', true, 1)
                await wait(500);
                await addLine(`\nIl semble que vous devez d√©filer les 5 roues crant√©es pour que le calcul soit correct... chaque nombre vont de 1 √† 20 (inclus). Hm. Pas facile.`, 'narration')
                await wait(500);
                await addLine(`\nAlors, quel est le code ? Je vous laisse exactement... hm. Le temps de prendre ma douche.`, 'error')
                await wait(500);
                await addLine(`\n¬´ D√©j√†, ce n'est pas un joueur de League Of Legends. ¬ª pensez-vous au moment o√π la bombe recommence √† bipper sous vos doigts. `, 'narration')
                await wait(500);
            }

        }

        async function checkAnswer() {
            const userInput = input.value.trim();
            if (userInput === '') return false;

            if (currentEnigme === 1) {
                await addLine('Super ! On peut toujours compter sur vous !\n', 'success');
                await wait(1000);
                return true;
            }
            else if (currentEnigme === 2) {
                if (input.value === 'CHIRAC') {

                    await addLine('Connexion r√©ussie !\n', 'success');
                    await wait(1000);
                    return true;
                } else {
                    await addLine('Mot de passe erron√©.', 'error');
                    if (nbtry === 2) {
                        await addLine(`\nVous reculez de votre chaise d'un air agac√©... tiens ? Un post-it d√©lav√© est coll√© sur l‚Äô√©cran ¬´ MDP : 67 72 73 82 65 67 ¬ª... un chef-d‚Äô≈ìuvre de cybers√©curit√©.\n`, 'narration')
                    }
                    else if (nbtry === 5) {
                        await addLine(`\nIl semble que le mot de passe sur le post-it soit cod√©...\n`, 'narration')
                    }
                    else if (nbtry === 10) {
                        await addLine(`\nUn code, un code... un code ASCII ! Votre fulgurance vous menera loin !\n`, 'narration')
                    }
                }
                await addLine('Entrez le mot de passe :');
            }
            else if (currentEnigme === 3) {
                if (input.value === 'route 192.168.27.254') {
                    await addLine(`Vous appuyez sur la touche Entr√©e, une goutte de sueur perlant sur votre front, esp√©rant avoir correctement calcul√© l‚Äôadresse r√©seau √† la main‚Ä¶\n`, 'narration')
                    await addLine(`Changement de passerelle effectu√©...`, '', true);
                    await addLine(`Connexion au r√©seau...`, '', true);
                    await addLine(`‚ô´ÔΩ•*:.ÔΩ°. .ÔΩ°.:* (·É¶Àò‚å£Àò·É¶) ‚ô´ÔΩ•*:.ÔΩ°. .ÔΩ°.:*ÔΩ•`, '', true, 100)
                    await wait(100);
                    await addLine('Connexion au r√©seau √©tablie !\n', 'success');
                    await wait(1000);
                    return true;
                }
                else if (input.value.startsWith('route')) {
                    await addLine(`Changement de passerelle effectu√©...`, '', true);
                    await addLine(`Connexion au r√©seau...`, '', true);
                    await addLine(`‚ô´ÔΩ•*:.ÔΩ°. .ÔΩ°.:* (·É¶Àò‚å£Àò·É¶) ‚ô´ÔΩ•*:.ÔΩ°. .ÔΩ°.:*ÔΩ•`, '', true, 100)
                    await wait(100);
                    await addLine(`√âchec de la connexion ‡≤•Ôπè‡≤•`, 'error');
                }
                else if (input.value.startsWith('ipconfig')) {
                    await addLine(`Adresse IP de la machine... : 192.168.20.1
Masque de sous-r√©seau...... : 255.255.248.0\n`);
                } else {
                    await addLine('La machine grogne.', 'error');

                }
                if (nbtry === 2) {
                    await addLine(`\nQue ferait ma√Ætre Filius ...? Fort de vos connaissances en r√©seau, vous vous rappelez commande ipconfig !`, 'narration');
                }
                else if (nbtry === 6) {
                    await addLine(`\nLe prof avait parl√© d'une convention pour configurer l'adresse du routeur, ¬´ Souvent dans un sous-r√©seau, on choisit le plus grand num√©ro d'h√¥te disponible pour l'adresse IP de la passerelle ¬ª.`, 'narration');
                }
            }
            else if (currentEnigme === 4) {
                if (input.value === 'cat documents/message.txt') {
                    return true;
                } else if (input.value === 'cat documents/portefeuille_bitcoin.txt') {
                    await addLine(`Montant sur le compte : 12443 Bitcoins`);
                    await addLine(`Cl√© du portfeuille : ‚ñà‚ñà1zP1‚ñà‚ñà‚ñà‚ñà‚ñàGef‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñàPTfT‚ñà‚ñà‚ñà‚ñàmv7D‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà`);
                    await addLine(`\nLes donn√©es semblent corrompues... dommage, vous aurez bien offert un vrai instrument √† votre professeur.`, 'narration');
                }
                else if (input.value === 'cat documents/trucs_a_faire.txt') {
                    await addLine(`   [X] Acheter une machine √† caf√© pour la salle des profs`);
                    await addLine(`   [ ] Pr√©parer les machines pour le bug de l'an 2000`);
                    await addLine(`   [ ] Corriger les copies des classes de 1√®re C`);
                    await addLine(`   [X] √âcrire le mdp de connexion pour G√©rard, il oublie tout...`);
                    await addLine(`   [ ] V√©rifier qu‚Äôil y a assez de place sur la disquette (1.44 Mo, c‚Äôest pr√©cieux)`);
                    await addLine(`\nUn prof qui oublie de corriger ses copies... √©trange.`, 'narration');
                } else if (input.value === 'cat documents/eleves_bannis.txt') {
                    await addLine('  * Patrick Mougin (a tent√© d‚Äôinstaller Doom)');
                    await addLine('  * Brigitte Lemoine (a utilis√© Wikip√©dia pour tricher √† son DS)');
                    await addLine('  * Martine Corbier (a imprim√© 237 pages d‚ÄôASCII art de Nirvana en cours d‚Äôinformatique)');
                    await addLine('  * G√©rard Bastien (a remplac√© le mot de passe du r√©seau par ¬´ WAZAAA ¬ª et a oubli√©)');
                    await addLine(`  * Arthur Rouquan (vous savez... on en tirera rien de bon de lui)`);
                    await addLine('  * Raymond Casteix (a chang√© la souris √† boule par une boule de mammouth "pour rigoler")');
                    await addLine('  * Monique Truchon (a cru que ‚Äúformat c:‚Äù √©tait une commande pour agrandir le texte)');
                    await addLine('  * Alain Berthier (a mis un fond d‚Äô√©cran X-Files et fait croire qu‚Äôun alien avait pirat√© le r√©seau)');
                    await addLine(`\nCe prof vous cache d√©finitivement des choses...`, 'narration');
                } else if (input.value === 'cat') {
                    await addLine(`Chemin du fichier manquant.`, 'error');
                }
                else if (input.value.startsWith('cat')) {
                    await addLine(`M√©moire corrompue, fichier innaccessible.`, 'error');
                }
                else if (input.value.startsWith('tree')) {
                    addLine(`‚îú‚îÄ‚îÄ code/
‚îÇ ‚†Ä ‚îú‚îÄ‚îÄ the_language_C.txt
‚îÇ ‚†Ä ‚îî‚îÄ‚îÄ programmes/
‚îÇ ‚†Ä‚†Ä‚†Ä‚†Ä ‚îú‚îÄ‚îÄ demineur2000.c
‚îÇ ‚†Ä‚†Ä‚†Ä‚†Ä ‚îî‚îÄ‚îÄ ageofempire2.exe
‚îú‚îÄ‚îÄ documents/
‚îÇ ¬† ‚îú‚îÄ‚îÄ trucs_a_faire.txt
‚îÇ ¬† ‚îú‚îÄ‚îÄ eleves_bannis.txt
‚îÇ ¬† ‚îú‚îÄ‚îÄ portefeuille_bitcoin.txt
‚îÇ ¬† ‚îî‚îÄ‚îÄ message.txt
‚îî‚îÄ‚îÄ travail/
    ‚îú‚îÄ‚îÄ films/
    ‚îÇ ¬† ‚îú‚îÄ‚îÄ terminator2.avi
    ‚îÇ ¬† ‚îú‚îÄ‚îÄ the_thing.avi
    ‚îÇ ¬† ‚îî‚îÄ‚îÄ alien.avi
    ‚îî‚îÄ‚îÄ musique/
    ¬† ¬†  ‚îú‚îÄ‚îÄ daft_punk.mp3
    ¬† ¬†  ‚îî‚îÄ‚îÄ dark_side_of_the_moon.wav`);
                } else if (input.value.startsWith('cd')) {
                    await addLine(`Commande corrompue.`, 'error');
                    await addLine(`\nVous criez "MAIS RIEN NE FONCTIONNE SUR CE TERMINAL" avant de vous rappeler que vous jouez √† un petit escape game r√©alis√© √† la va-vite par votre professeur en une nuit blanche.`, 'narration');
                    await wait(500)
                    await addLine(`\nVous entendez un son de ukul√©l√© s'arr√™ter au loin suivi de quelques sanglots.`, 'comment')
                    await wait(500)
                    await addLine(`\n... vous esp√©rez qu'il corrige juste une mauvaise copie.`, 'narration');
                } else {
                    await addLine('La machine grogne.', 'error');

                }
                if (nbtry === 2) {
                    await addLine(`\nMes documents... √ßa doit √™tre un dossier. La commande tree vous permettra d'y voir un peu plus clair.`, 'narration');
                }
                else if (nbtry === 6) {
                    await addLine(`\nDans le jeu que le professeur a honteusement plagi√©, on utilisait la commande cat (‚âΩ^‚Ä¢‚©ä‚Ä¢^‚âº) pour afficher le contenu d'un fichier.`, 'narration');
                }


            }
            else if (currentEnigme === 5) {

                if (input.value === '101010') {
                    return true;
                } else {

                    if (nbtry === 0) {
                        await addLine('AHAHAHAH CA NE CONNAIT M√äME PAS SES CLASSIQUES', 'error');
                        await addLine(`\nAvant de c√©der √† l‚Äôenvie de fracasser votre clavier, rappelez-vous que vu son √©paisseur, c‚Äôest plut√¥t lui qui risque de vous fracturer les phalanges.`, 'narration')
                    } else if (nbtry === 1) {
                        await addLine('AHAHAHAH LE NULLOS ü´µ ü§£ ü´µ', 'error');
                        await addLine(`\n‚ÄúDes emojis ?!‚Äù vous exclamez-vous. Apparemment, il a pris le temps de mettre √† jour le terminal‚Ä¶ juste pour mieux se moquer de vous.`, 'narration')
                        await addLine('...', 'narration', true, 800)
                        await addLine(`üòè`, 'narration')
                        await addLine('...', 'narration', true, 800)
                        await addLine(`C'√©tait trop tentant, excusez-moi. Je redeviens un narrateur extra-di√©g√©tique. `, 'narration')
                    } else {
                        await addLine('BAH ALORS ?! ON EST BLOQU√â ?!', 'error');
                        await addLine(`\nVous conservez votre sang froid.`, 'narration')
                    }

                    if (nbtry === 2) {
                        await addLine(`\nAvant de sortir de la salle du serveur, pour esp√©rer croiser un professeur de philo, une vieille r√©f√©rence vous revient en m√©moire : ce bouquin o√π des voyageurs interstellaires traversent la galaxie toujours munis d'une serviette de bain. Apr√®s tout, c‚Äôest toujours utile, une serviette.`, 'narration')
                    }

                    if (nbtry === 3) {
                        await addLine(`\nQUARANTE DEUX ! MAIS OUI !`, 'narration')
                    }

                    if (nbtry === 4) {
                        await addLine(`\nLa conversion en binaire n'a pas de secret pour vous, √©videmment, vous avez simplement mal saisi la r√©ponse.`, 'narration')
                    }
                }


            }
            else if (currentEnigme === 6) {
                if (input.value === '0.30000000000000004') {
                    await addLine('Tu connais parfaitement la norme IEEE-754, int√©ressant !\n', 'success');
                    await wait(200);
                    await addLine(`¬´ parfaitement ¬ª... ce hacker semble avoir une haute opinion de vous. `, 'narration')
                    await wait(1000);
                    return true;
                } else {
                    await addLine(`Ce n'est pas ce que me dit ma machine...`, 'error');
                    if (nbtry === 2) {
                        await addLine(`\nBesoin d'une console Python ? Le site console.basthon.fr est toujours l√† pour vous !`, 'narration')
                    }
                }
            }
            else if (currentEnigme === 7) {


                if (input.value === '30 88 38 46 42') {
                    await addLine(`Vous sortez vos ciseaux √† bouts ronds ‚Äî on n'est jamais trop prudent ‚Äî pour couper les c√¢bles dans cet ordre... \n`, 'narration');
                    await addLine(`La bombe s'√©teint.`, 'success');
                    await wait(500);


                    return true;
                } else {
                    await addLine(`BOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOOMMMMMM`, 'bad', false);
                    await wait(500);
                    await addLine(`\nMais...`, 'narration', true, 200);
                    await wait(500);
                    await addLine(`\nVous ouvrez les yeux devant la bombe, pr√™t √† couper les c√¢bles √† nouveau. Vous vous demandez si, finalement, la mort n'√©tait pas une issue plus favorable.`, 'narration');
                    await wait(500);
                    await addLine(`\nDonne les c√¢bles que tu coupes... comme : ¬´ 5 6 8 ¬ª (ne fais pas √ßa ou tu risques d'√™tre toi aussi d√©coup√© en deux ahahah)`, 'error')

                }
            }
            else if (currentEnigme === 8) {
                if (input.value === '20 20 2 1 1') {
                    await addLine(`*clic*`, 'comment');
                    await wait(500);
                    await addLine(`\nLe m√©canisme de la bombe s'ouvre devant vous.\n`, 'success');
                    await wait(500);
                    await addLine(`4h du matin ?! Bon, il est temps d'aller dormir... et je ne sais m√™me pas comment finir cette histoire ! Mais bien jou√© d'en √™tre arriv√© l√†... j'ai toujours cru en vous.`, 'narration');

                    await wait(1000);
                    return true;
                }

                await addLine(`Le m√©canisme semble toujours aussi bloqu√©...\n`, 'comment');
                await wait(1000);

                if (nbtry === 1) {
                    await addLine(`Vous avez beau essayer des combinaisons, votre cerveau surchauffe. Vous vous demandez si ce n'est pas une question √† donner √† manger √† un Python...`, 'narration')
                } else if (nbtry === 3) {
                    await addLine(`Quelques boucles imbriqu√©es devraient...`, 'narration')
                    await addLine(`JE SUIS DE RETOUR !`, 'error')
                    await wait(1000);
                    await addLine(`Quoi ? D√©j√† ?! Et tu pourrais attendre que j'ai fini ma narration, peut-√™tre ?`, 'narration')
                    await wait(1000);
                    await addLine(`Un m√©chant coupe toujours la parole, j'ai vu √ßa dans Scarface.`, 'error')
                    await wait(1000);
                    await addLine(`... il n√©glige la politesse et sa douche apparemment. `, 'narration')
                    await wait(1000);
                    await addLine(`C'√©tait une douche au d√©o !`, 'error')
                    await wait(1000);
                    await addLine(`Je............`, 'narration', true, 300)
                    await addLine(`Essayez √† nouveau mon cher joueur.`, 'narration')
                }
            }
            nbtry++;
            return false;
        }

        async function nextEnigme() {
            currentEnigme++;
            nbtry = 0
            enigmeShown = false;
            input.value = '';
            await showEnigme();
        }

        function skipAnimation() {
            if (isTyping && currentTyping) {
                if (currentTyping.timeout) {
                    clearTimeout(currentTyping.timeout);
                }
                if (currentTyping.reject) {
                    currentTyping.reject();
                }
            }
        }

        input.addEventListener('keyup', async (e) => {
            if (e.key === 'Enter') {
                if (isTyping) {
                    skipAnimation();
                    return;
                }

                const userInput = input.value.trim();
                if (userInput === '') return;

                addLine(`> ${userInput}`, 'user', false);

                if (!enigmeShown) {
                    await showEnigme();
                } else {
                    const isCorrect = await checkAnswer();
                    if (isCorrect) {
                        await nextEnigme();
                    }
                }

                input.value = '';
            }
        });

        // D√©marrage du jeu
        (async function () {
            currentEnigme = 1;
            await showEnigme();
        })();
    </script>
</body>

</html>